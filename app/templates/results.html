
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Results</title>
<script>
function exportTableToExcel(tableID, filename = ''){
    var downloadLink;
    var dataType = 'application/vnd.ms-excel';
    var tableSelect = document.getElementById(tableID);
    var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');

    // Specify file name
    filename = filename?filename+'.xls':'excel_data.xls';

    // Create download link element
    downloadLink = document.createElement("a");

    document.body.appendChild(downloadLink);

    if(navigator.msSaveOrOpenBlob){
        var blob = new Blob(['\ufeff', tableHTML], {
            type: dataType
        });
        navigator.msSaveOrOpenBlob( blob, filename);
    }else{
        // Create a link to the file
        downloadLink.href = 'data:' + dataType + ', ' + tableHTML;

        // Setting the file name
        downloadLink.download = filename;

        //triggering the function
        downloadLink.click();
    }
}
</script>
</head>
<body>
    <h1 style="color: #5e9ca0;">Modules</h1>
    <h2 style="color: #0B7478">The created modules are:</h2>
    <h3 style="color: #0B7478">{{abs_modules['headline']}}</a></h3>
        <table id="tblDataAbs">
            <tbody>
                  {% for module in abs_len %}
                    <tr>
                     <td> Module number {{module}}:</td>
                     <td>
                    {% for cy in abs_modules[module] %}
                    {{cy}},
                    {% endfor %}
                    </td>
                  </tr>
                {% endfor %}
            </tbody>
        </table>
        <button onclick="exportTableToExcel('tblDataAbs', 'abs modules')">Export Absolute Modules To Excel File</button>
       <h3 style="color: #0B7478">{{adj_modules['headline']}}</h3>
        <table id="tblDataAdj">
            <tbody>
                  {% for module in adj_len %}
                    <tr>
                     <td> Module number {{module}}:</td>
                     <td>
                    {% for cy in adj_modules[module] %}
                    {{cy}},
                    {% endfor %}
                    </td>
                  </tr>
                {% endfor %}
            </tbody>
        </table>
    <button onclick="exportTableToExcel('tblDataAdj', 'adj modules')">Export Adjusted Modules To Excel File</button>
    {% if results %}
    <h1 style="color: #5e9ca0;">Figures</h1>
    <h2 style="color: #0B7478">For download a figure, click on it!</h2>
        <table>
            <tbody>
            {% for var in results %}
                <tr>
                    <td style="color: #0B7478"><span style= "font-size: 16pt;"> {{var['headline']}} </span></td>
                    <td><a download="{{ var['name'] }}" href= "{{ var['path'] }}" title="Image: {{var['headline']}}">
                    <img src="{{ var['path'] }}" width=" {{var['width']}}" height=" {{var['height']}}" >
                    </a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        No results :(
    {% endif %}
</body>
</html>

